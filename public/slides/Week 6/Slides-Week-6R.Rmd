---
title: "Exploring NFL Ticket Prices in R"
subtitle: "EDP 613"
author: "Week 6"
output: 
 xaringan::moon_reader:
   css: xaringan-themer.css
---

```{r setup, include=FALSE, purl=FALSE}
library(tidyverse)
library(psych)
library(tigerstats)
```

```{r echo = FALSE, purl=FALSE}
xaringanthemer::style_duo(
  primary_color = "#212121",
  secondary_color = "#bb86fc",
  header_font_google = xaringanthemer::google_font("Jost", "600"),
  text_font_google   = xaringanthemer::google_font("Jost", "400")
)

xaringanExtra::use_xaringan_extra(c("tile_view", "animate_css", "tachyons"))
```

```{r echo = FALSE, eval = TRUE, message=FALSE}
library(tidyverse)
``` 

# Bring in the data set

```{r echo = TRUE, eval = TRUE}
prices <- read_csv("2014-average-ticket-price.csv", 
                   na = "NA")
```
---

# Take a look at the entire frame...

```{r echo = TRUE, eval = TRUE}
prices
```

---

# ...or just the first six rows

```{r echo = TRUE, eval = TRUE}
head(prices)
```
---

## 1. What was the average ticket price for all 2014-2015 NFL games?


```{r echo = TRUE, eval = TRUE, out.width="50%", fig.align='center'}
hist(prices$`Avg TP, $`)
```

---

## 2. What was the average ticket price for all 2014-2015 NFL games by division? Provide counts and a histogram.

```{r echo = TRUE, eval = TRUE}
unique(prices$Division)
```

---

### Cases

```{r echo = TRUE, eval = TRUE}
afc_north <- filter(prices, Division == "AFC North")
afc_east <- filter(prices, Division == "AFC East")
afc_west <- filter(prices, Division == "AFC West")
afc_south <- filter(prices, Division == "AFC South")
nfc_north <- filter(prices, Division == "NFC North")
nfc_east <- filter(prices, Division == "NFC East")
nfc_west <- filter(prices, Division == "NFC West")
nfc_south <- filter(prices, Division == "NFC South")
```

---

## Check

```{r echo = TRUE, eval = TRUE}
afc_north 
```

---

## AFC North

```{r echo = TRUE, eval = TRUE, out.width="50%", fig.align='center'}
hist(afc_north$`Avg TP, $`)
```

---

## AFC East: 

```{r echo = TRUE, eval = TRUE, out.width="50%", fig.align='center'}
hist(afc_east$`Avg TP, $`)
```

---

## AFC West: 

```{r echo = TRUE, eval = TRUE, out.width="50%", fig.align='center'}
hist(afc_west$`Avg TP, $`)
```

---

## AFC South: 


```{r echo = TRUE, eval = TRUE, out.width="50%", fig.align='center'}
hist(afc_south$`Avg TP, $`)
```

---

## NFC North: 


```{r echo = TRUE, eval = TRUE, out.width="50%", fig.align='center'}
hist(nfc_north$`Avg TP, $`)
```

---

## NFC East: 

<center>
```{r echo = TRUE, eval = TRUE, out.width="50%", fig.align='center'}
hist(nfc_east$`Avg TP, $`)
```

---

## NFC West: 

<center>
```{r echo = TRUE, eval = TRUE, out.width="50%", fig.align='center'}
hist(nfc_west$`Avg TP, $`)
```

---

## NFC South: 

```{r echo = TRUE, eval = TRUE, out.width="50%", fig.align='center'}
hist(nfc_south$`Avg TP, $`)
```

---

## AFC: 

```{r echo = TRUE, eval = TRUE}
median(afc_north$`Avg TP, $`, na.rm = TRUE)
```

```{r echo = TRUE, eval = TRUE}
median(afc_east$`Avg TP, $`, na.rm = TRUE)
```

```{r echo = TRUE, eval = TRUE}
median(afc_west$`Avg TP, $`, na.rm = TRUE)
```

```{r echo = TRUE, eval = TRUE}
median(afc_south$`Avg TP, $`, na.rm = TRUE)
```

---

## NFC

```{r echo = TRUE, eval = TRUE}
median(nfc_north$`Avg TP, $`, na.rm = TRUE)
```

```{r echo = TRUE, eval = TRUE}
median(nfc_east$`Avg TP, $`, na.rm = TRUE)
```

```{r echo = TRUE, eval = TRUE}
median(nfc_west$`Avg TP, $`, na.rm = TRUE)
```

```{r echo = TRUE, eval = TRUE}
median(nfc_south$`Avg TP, $`, na.rm = TRUE)
```

---

## 3. How likely was it be for a fan of an AFC North team to play $100 for a ticket during the 2014-2015 NFL season?

```{r echo = TRUE, eval = TRUE}
x = 100
mu_afc_north = mean(afc_north$`Avg TP, $`)
sigma_afc_north = sd(afc_north$`Avg TP, $`)
```

```{r echo = TRUE, eval = TRUE}
z_score_afc_north = (x - mu_afc_north)/sigma_afc_north
z_score_afc_north

pnorm(z_score_afc_north)
```


---


```{r echo = TRUE, eval = TRUE}
mu_afc_north

pnorm(x, mu_afc_north, sigma_afc_north)
```

---

```{r echo = TRUE, eval = TRUE, out.width="50%",  fig.align='center'}
pnormGC(x, 
        region = "below",
        mean = mu_afc_north,
        sd = sigma_afc_north,
        graph = TRUE)
```

---

```{r echo = TRUE, eval = TRUE, out.width="40%",  fig.align='center'}
ggplot(afc_north, aes(x = str_wrap(Event, 30), y = `Avg TP, $`, fill = `Avg TP, $`)) +
  geom_col(show.legend = FALSE) +
  geom_hline(aes(yintercept = median(`Avg TP, $`)), color = "#ee4035", size = 2, alpha = 0.5) +
  geom_hline(aes(yintercept = mean(`Avg TP, $`)), color = "#0392cf", size = 2, alpha = 0.5) +
  scale_fill_gradient(low = "#e5c3c6", high ="#bcd2d0") +
  ggtitle("Histogram of Average AFC North Ticket Prices by Event") +
  xlab("Event") +
  ylab("Price") +
  theme_minimal()  +
  theme(axis.text.x = element_text(angle = 90),
        panel.grid.major.x = element_blank(),
        panel.grid.minor = element_blank())
```

---

```{r echo = FALSE, eval = TRUE, out.width="80%",  fig.align='center'}
ggplot(afc_north, aes(x = str_wrap(Event, 30), y = `Avg TP, $`, fill = `Avg TP, $`)) +
  geom_col(show.legend = FALSE) +
  geom_hline(aes(yintercept = median(`Avg TP, $`)), color = "#ee4035", size = 2, alpha = 0.5) +
  geom_hline(aes(yintercept = mean(`Avg TP, $`)), color = "#0392cf", size = 2, alpha = 0.5) +
  scale_fill_gradient(low = "#e5c3c6", high ="#bcd2d0") +
  ggtitle("Histogram of Average AFC North Ticket Prices by Event") +
  xlab("Event") +
  ylab("Price") +
  theme_minimal()  +
  theme(axis.text.x = element_text(angle = 90),
        panel.grid.major.x = element_blank(),
        panel.grid.minor = element_blank())
```

---

## Thats it!