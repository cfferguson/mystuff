---
title: "Testing Hypotheses"
subtitle: "EDP 613"
author: "Week 9"
output: 
 xaringan::moon_reader:
   css: xaringan-themer.css
   nature:
     ratio: 16:9
     highlightStyle: github
     highlightLines: true
     countIncrementalSlides: false
     navigation:
         scroll: false
---

<style>

.center2 {
  margin: 0;
  position: absolute;
  top: 50%;
  left: 50%;
  -ms-transform: translate(-50%, -50%);
  transform: translate(-50%, -50%);
}

ol.nostyle li.nostyle {

  list-style-type: none;
  
}

.brmedium {
            display: block;
            margin-bottom: 7em;
        }
          
.brlarge {
            display: block;
            margin-bottom: 17em;
        }

</style>

```{r setup, include=FALSE, purl=FALSE}
library(tidyverse)
library(knitr)
library(kableExtra)
library(fontawesome)
library(here)
library(DT)
library(scales)
library(latex2exp)
library(showtext)
font_add_google("Roboto Condensed", "roboto")
showtext_auto()
```
```{r echo = FALSE, purl=FALSE}
xaringanthemer::style_duo(
  primary_color = "#212121",
  secondary_color = "#f4eebf",
  table_row_border_color = "#212121",
  table_row_even_background_color = "#212121",
  footnote_font_size = "0.6em",
  header_font_google = xaringanthemer::google_font("Roboto Condensed", "700"),
  text_font_google   = xaringanthemer::google_font("Roboto Condensed", "400")
)
xaringanExtra::use_xaringan_extra(c("tile_view", "animate_css", "tachyons"))

xaringanExtra::use_logo(
  image_url = here::here("static", "img", "course_hex.png"),
  link_url = "https://edp613.asocialdatascientist.com",
  position = xaringanExtra::css_position(bottom = "1em", left = "1em")
)
```

```{r echo = FALSE, eval = TRUE, message=FALSE}
library(tidyverse)
``` 

```{r echo = FALSE}
shading_geq <- function(x, lower_bound) {
  y = dnorm(x, mean = m, sd = stdev)
  y[x < lower_bound] <- NA
  return(y)
}

shading_leq <- function(x, upper_bound) {
  y = dnorm(x, mean = m, sd = stdev)
  y[x > upper_bound] <- NA
  return(y)
}

shading_beq <- function(x, lower_bound, upper_bound) {
  y = dnorm(x, mean = m, sd = stdev)
  y[x < lower_bound | x > upper_bound] <- NA
  return(y)
}

shading_neq <- function(x, lower_bound, upper_bound) {
  y = dnorm(x, mean = m, sd = stdev)
  y[x > lower_bound | x < upper_bound] <- NA
  return(y)
}
```

# A Note About The Slides

Currently the equations do not show up properly in Firefox. Other browsers such as Chrome and Safari do work. 

---

# A Note About Previous Items

We're going to use some introduce some concepts from Chapter 7 here as well

---

# Definitions

The **margin of error** (MoE) is 

--

>- *Formally* : the range of values above and below a sample statistic within a confidence interval. 

--

>- *In a nutshell* : how many percentage points your results will differ from the real population value.

--

>- NOT the same as a **confidence interval**

--

(Statistical) **significance** is 

--

>- *Formally* : a measure of the probability of the null hypothesis being true compared to the acceptable level of uncertainty regarding the true answer

--

>- *In a nutshell* : a result is probably not due to chance so it is likely real

--

>- NOT the same as a **practical significance**

---

# Interpretation 

.pull-left[
<center>
Example result:<br><br>
A <b>95%</b> confidence interval with a<br><b>3% margin of error</b>
</center>
]

--

.pull-right[
<center>
What it means:<br><br>
Your statistic will be within<br><b>3 percentage points</b> of the real population value<br><b>95%</b> of the time
</center>
]

--

<br>
<br>
<br>
<center>
The MoE is a probability!
</center>

---

# Back to Hypothesis Testing

Recall:



--

.pull-left[
The **null hypothesis $H_0$** states 

>- *Formally* : that a parameter is equal to a specific value

>- *Informally* : nothing probably happened
]

--

.pull-right[
The **alternative hypothesis $H_1$** states 

>- *Formally* : that a parameter differs from the value specified by the null hypothesis

>- *Informally* : something probably happened

]

---

# More about Hypothesis Testing

Say a null hypothesis is $H_0\colon\mu=50$. Then three things can occur from a frequentist perspective

--

- $H_1 < 50$: alternative hypothesis states that the parameter is *less* than the value of the null.

--

>- You know to test for everything to the **left** of $H_1 = 50$.

--

>- Called a **left-tailed test**

--

<br>
- $H_1 > 50$: alternative hypothesis states that the parameter is *more* than the value of the null.

--

>- You know to test for everything to the **right** of $H_1 = 50$.

--

>- Called a **right-tailed test**

--

<br>
- $H_1 \neq 50$: alternative hypothesis states that the parameter is *note* the value of the null.

--

>- You know to test for everything to the **left** and **right** of $H_1 = 50$.

--

>- Called a **two-tailed test**

---

# $H_1 < H_0$: Left-Tailed Test

```{r echo = FALSE, eval= TRUE, warning = FALSE, out.width = '40%', fig.align='center'}
ggplot(NULL, aes(c(-3,3))) +
  geom_area(stat = "function", 
            fun = dnorm, 
            fill = "#428bca", 
            xlim = c(-3, 0.95), 
            color = "#FFFFFF",
            size = 1) +
  geom_area(stat = "function", 
            fun = dnorm, 
            fill = "#212121", 
            xlim = c(1.05, 3), 
            color = "#FFFFFF", 
            size = 1) +
  geom_area(stat = "function", 
            fun = dnorm, 
            fill = "transparent",
            xlim = c(-3, 3), 
            color = "#FFFFFF", 
            size = 1) +
  labs(x = TeX("$\\mu$"), 
       y = "") +
  scale_y_continuous(breaks = NULL) +
  scale_x_continuous(breaks = 1,
                     labels = TeX("$z$")) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        axis.text.x = element_text(color = "#FFFFFF",
                                    size = 26),
        axis.title.x = element_text(color = "#FFFFFF",
                                    size = 30),
        panel.background = element_rect(fill = "#212121"),
        plot.background = element_rect(fill = "#212121", 
                                       color = NA))
```

---

# $H_1 > H_0$: Right-Tailed Test

```{r echo = FALSE, eval= TRUE, warning = FALSE, out.width = '40%', fig.align='center'}
ggplot(NULL, aes(c(-3,3))) +
  geom_area(stat = "function",
            fun = dnorm,
            fill = "#212121", 
            xlim = c(-3, 0.95), 
            color = "#FFFFFF", 
            size = 1) +
  geom_area(stat = "function", 
            fun = dnorm, 
            fill = "#428bca",
            xlim = c(1.05, 3), 
            color = "#FFFFFF", 
            size = 1) +
  geom_area(stat = "function", 
            fun = dnorm, 
            fill = "transparent",
            xlim = c(-3, 3), 
            color = "#FFFFFF", 
            size = 1) +
  labs(x = TeX("$\\mu$"), 
       y = "") +
  scale_y_continuous(breaks = NULL) +
  scale_x_continuous(breaks = 1,
                     labels = TeX("$z$")) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        axis.text.x = element_text(color = "#FFFFFF",
                                    size = 26),
        axis.title.x = element_text(color = "#FFFFFF",
                                    size = 30),
        panel.background = element_rect(fill = "#212121"),
        plot.background = element_rect(fill = "#212121", 
                                       color = NA))
```

---

# $H_1 \neq H_0$: Two-Tailed Test

```{r echo = FALSE, eval= TRUE, warning = FALSE, out.width = '40%', fig.align='center'}
ggplot(NULL, aes(c(-3,3))) +
  geom_area(stat = "function", 
            fun = dnorm, 
            fill = "#428bca", 
            xlim = c(-3, 0.95), 
            color = "#FFFFFF", 
            size = 1) +
  geom_area(stat = "function", 
            fun = dnorm, 
            fill = "#428bca", 
            xlim = c(1.05, 3), 
            color = "#FFFFFF", 
            size = 1) +
  geom_area(stat = "function", 
            fun = dnorm, 
            fill = "transparent",
            xlim = c(-3, 3), 
            color = "#FFFFFF", 
            size = 1) +
  labs(x = TeX("$\\mu$"), 
       y = "") +
  scale_y_continuous(breaks = NULL) +
  scale_x_continuous(breaks = 1,
                     labels = TeX("$z$")) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        axis.text.x = element_text(color = "#FFFFFF",
                                    size = 26),
        axis.title.x = element_text(color = "#FFFFFF",
                                    size = 30),
        panel.background = element_rect(fill = "#212121"),
        plot.background = element_rect(fill = "#212121", 
                                       color = NA))
```

---

# Testing Methods

--

- Critical Value (*CV*)

--

- $p$-value

---

# Critical Value

- Uses a **test statistic** - determines how strong the disagreement between a sample mean and a null hypothesis. 

--

- Idea: We should reject $H_0$ if the value of the test statistic is unusual when we assume $H_0$ to be true.

--

- Process

--

   - We choose a *CV* which forms a boundary between values that are considered unusual and values that are not.

--

   - The region containing the unusual values is called the **critical region**.
    
--

   - If the value of the test statistic is in the critical regions, we *reject* $H_0$.

---

# Transitioning (Again!)

<center>
Going from a `z`-distribution (known population variance using `z`-scores)
</center>

--

<br>
<br>
<br>
<center>to</center>
<br>
<br>
<br>

--

<center>
a `t`-distribution (known sample variance using `t`-tests)
</center>

---

# Note

We have to assume that for a large enough sample size, the $t$-distribution will closely match, or estimate, the a $z$-distribution 

---

# Things to note

- $t$-distribution table can be located in Appendix C.

--

- Assumptions

--

   - *Normality* - Samples are drawn from a population that fits a bell curve 
    
--

   - *Independence* - Samples do not share values

--

  - *Random Sampling* - Samples are randomized
  
--

  - ***Homogeneity*** (for more than one sample) - Samples have a similar makeup

---

# One-sample $t$-test

- allows us to determine whether the mean of a sample data set is different than a known value

--

- used when the population variance is not known

--

- can be used when the sample size is small ~ typically $N<30$.


---

# What the heck is a *degree of freedom*?

--

1. Forget statistics

--

2. Say you only own seven hats and want to wear a different one each day of the week.

--

3. Process
  - Day 1: Choose from 7
  
  - Day 2: Choose from 6<br>
    &emsp;&emsp;&emsp;&emsp;.<br>
    &emsp;&emsp;&emsp;&emsp;.

--

<ol class="nostyle"> 
  <li class="nostyle">
    <ul> 
      <li class="nostyle">&emsp;&emsp;&emsp;&emsp;.</li>
      <li class="nostyle">&emsp;&emsp;&emsp;&emsp;.</li>
      <br>
      <li>Day 6: Choose from 2</li>
      <br>
      <li>Day 7: Choose from 1</li>
    </ul>
  </li>
</ol>

--

<ol start=4>
You had 7 - 1 = <b>6</b> <i>days of hat freedom!</i>
</ol>

--

<center>
That's essentially a degree of freedom (written <i>df </i>)
</center>

---

# Formula for a $t$-distribution

.center2[
.pull-left[
<center>
<i>t</i>-distribution<br><br>
</center>

$$t = \frac{\overline{Y}-\mu}{s/\sqrt{N}}$$
]

.pull-right[
<center>
<i>with degrees of freedom<br><br>
</center>

$$df = N-1$$
]
]

---

# Example

.center2[
```{r eval = TRUE, echo = FALSE}
income <- tibble(
  
Region = c("United States",
             "West Virginia"),

`Median Household Income` = c("$68,703",
                              "$48,850"),

`Median Male Salary` = c("$57,511",
                         "$57,456"),

`Median Female Salary` = c("$43,820",
                           "$47,299"),

Population = c("331,449,281 ",
                "1,793,716"),

Households = c("139,684,244",
               "763,831")

)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
kable(income, 
      escape = FALSE,
      align = 'cccccc') %>%
  kable_styling(full_width = FALSE) %>%
  column_spec(1, width = "10em") %>%
  column_spec(2, width = "10em") %>%
  column_spec(3, width = "10em") %>%
  column_spec(4, width = "10em") %>%
  column_spec(5, width = "10em") %>%
  row_spec(0, background = "#212121") %>%
  row_spec(2, background = "#212121")
```
]

--

We want to determine if the median household income of West Virginia counties is different than the national average.
<span class="brlarge"><span> 

--

From <b>Median Household Income</b>, we think WV (48,850 USD) is *practically lower* than the US (68,850 USD), but is it *significantly lower *?

---

## Hypothesis

<span class="brmedium"><span> 

.pull-left[
$$H_0$$<br><br> 
The <b>Median Household Income</b> of West Virginia counties is NOT significantly less than the national average
]

--

.pull-right[
$$H_1$$<br><br> The <b>Median Household Income</b> of West Virginia counties is significantly less than the national average
]

---

## Population & Sample

- $\mu = 68,703$ USD

- Sample
  - $N=61$ people with $s=5075.28$ USD and $\overline{Y} = 45732.20$ USD
  
  - *df*: $61-1 = 60$

- CV: $\pm 2$

---

## Calulations

\begin{aligned}
t &= \dfrac{19253.2-27334.0}{3075.28/\sqrt{50}} \\
 &\approx -18.58
\end{aligned}

So we reject $H_0$. 

Interpretation: The per capita income is significantly less than the national average!
 

---

# Two-sample $t$-test

Used to compare one sample mean to another.

- We use two different test: 
  - Equal variances
  - Unequal variances (assumed)

- **Homoscedasticity** – the assumption of equal variances.

---

# Formulas

- $S_{\overline{Y_1}-\overline{Y_1}} = \sqrt{\dfrac{(N_1-1)\cdot s_1^2+(N_2-1)\cdot s_2^2}{(N_1+N_2)-2}}\cdot\sqrt{\dfrac{N_1+N_2}{N_1\cdot N_2}}$

- $t = \dfrac{\overline{Y_1}-\overline{Y_2}}{S_{\overline{Y_1}-\overline{Y_1}}}$

- $df = (N_1+N_2)-2$

---

# Example

At the Olympic level of competition, even the smallest factors can make the difference between winning and losing. 

Pelton (1983) has shown that Olympic marksmen shoot much better if they fire between heartbeats, rather than squeezing the trigger during a heartbeat.

The small vibration caused by a heartbeat appears to be sufficient to affect the marksman’s aim.

---

# Samples

A sample of six (6) Olympic marksmen fires a series of rounds while a researcher records heartbeats.  For each marksman, an accuracy score (out of 100) is recorded for shots fired during heartbeats and for shots fired between heartbeats.  Do the data indicate a significant difference? 

```{r eval = TRUE, echo = FALSE}
heart <- tibble(
`During Heartbeats` = c(93, 90, 95, 92, 95, 91),

`Between Heartbeats` = c(98,94,96,91,97,97)

)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
kable(heart, 
      escape = FALSE,
      align = 'cc') %>%
  kable_styling(full_width = FALSE) %>%
  column_spec(1, width = "10em") %>%
  column_spec(2, width = "10em") %>%
  row_spec(0, background = "#212121") %>%
  row_spec(2, background = "#212121")
```

---

# Setup

- Research question: Is better accuracy achieved by marksmen when firing the trigger between heartbeats than during a heartbeat?

- Hypothesis: 
  - $H_0: \mu \geq 0$ – The average accuracy score is equal to or better when measured between heartbeats than during heartbeats.
  - $H_1: \mu < 0$  – The average accuracy score is worse when measures between heartbeats than during heartbeats.

- Alpha: $\alpha=0.05$

---

Appendix C: 

- $df = 6-1 = 5$

- $t_{critical} = -2.015$ 


```{r eval = TRUE, echo = FALSE}
heart_diff <- tibble(
`During Heartbeats` = c(93, 90, 95, 92, 95, 91, NA),

`Between Heartbeats` = c(98,94,96,91,97,97,NA),

Difference = c(-5,-4,-1,1,-2,-6,-17),

`Variance of Difference` = c(25,16,1,1,4,36,83)

)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
kable(heart_diff , 
      escape = FALSE,
      align = 'cc') %>%
  kable_styling(full_width = FALSE) %>%
  column_spec(1, width = "10em") %>%
  column_spec(2, width = "10em") %>%
  column_spec(3, width = "10em") %>%
  column_spec(4, width = "10em") %>%
  row_spec(0, background = "#212121") %>%
  row_spec(2, background = "#212121")
```

---

# Descriptives

- Mean: $\dfrac{-17}{6}\approx -2.83$

--

- SS: $83-\dfrac{(-17)^2}{6} \approx 34.83$

--

- Variance: $\dfrac{34.83}{6-1} \approx 6.97$

--

- Standard Deviation: $\sqrt{6.97} \approx 2.64$

---

# Calculations

- Standard Error: $\dfrac{2.64}{\sqrt{6}}\approx 1.08$

- Test Statistic: $\dfrac{-2.83-0}{1.08}\approx -2.62$

---

# Decision

Since $-2.62<-2.015$, we reject $H_0$.

--

Interpretation: Marksmen are significantly more accurate when they pull the trigger between heartbeats than during a heartbeat.

---

## That's it. Take a break before our R session!